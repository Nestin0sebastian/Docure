<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>User Dashboard</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/assetsb/imgs/theme/favicon.svg">
    <!-- Template CSS -->
    <link href="/assetsb/css/main.css" rel="stylesheet" type="text/css" />
    <style>
        .content-main {
            padding: 20px;
        }

        .content-header {
            margin-bottom: 20px;
        }

        .card {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .card-header {
            padding: 15px;
            border-bottom: 1px solid #e6e6e6;
            background: #f8f9fa;
            border-radius: 8px 8px 0 0;
        }

        .card-body {
            padding: 15px;
        }

        .itemlist {
            border-bottom: 1px solid #e6e6e6;
            padding: 15px 0;
        }

        .itemlist:last-child {
            border-bottom: none;
        }

        .row {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
        }

        .col {
            padding: 0 15px;
            flex: 1;
        }

        .col-4 {
            flex: 0 0 25%;
            max-width: 25%;
        }

        .col-8 {
            flex: 0 0 50%;
            max-width: 50%;
        }

        .col-lg-2, .col-sm-2 {
            flex: 0 0 16.6667%;
            max-width: 16.6667%;
        }

        .col-lg-3, .col-sm-3 {
            flex: 0 0 25%;
            max-width: 25%;
        }

        .text-center {
            text-align: center;
        }

        .text-end {
            text-align: end;
        }

        .text-bold {
            font-weight: bold;
        }

        .text-green {
            color: #4CAF50;
        }

        .text-large {
            font-size: larger;
        }

        .btn {
            display: inline-block;
            font-weight: 400;
            text-align: center;
            white-space: nowrap;
            vertical-align: middle;
            user-select: none;
            border: 1px solid transparent;
            padding: .375rem .75rem;
            font-size: 1rem;
            line-height: 1.5;
            border-radius: .375rem;
            transition: color .15s ease-in-out, background-color .15s ease-in-out, border-color .15s ease-in-out, box-shadow .15s ease-in-out;
        }

        .btn-brand {
            color: #fff;
            background-color: #4CAF50;
            border-color: #4CAF50;
        }

        .btn-brand:hover {
            background-color: #45a049;
            border-color: #45a049;
        }

        .btn-light {
            color: #212529;
            background-color: #f8f9fa;
            border-color: #f8f9fa;
        }

        .btn-light:hover {
            background-color: #e2e6ea;
            border-color: #dae0e5;
        }
        .text-bold {
        font-weight: bold;
    }
    .text-green {
        color: #4CAF50;
    }
    .text-large {
        font-size: larger;
    }
    .card {
        background: #fff;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
    }
    .card-header, .card-body {
        padding: 15px;
    }
    .itemlist {
        border-bottom: 1px solid #e6e6e6;
        padding: 15px 0;
    }
    .itemlist:last-child {
        border-bottom: none;
    }
    .btn-light {
        background-color: #f8f9fa;
        border: 1px solid #dee2e6;
    }
    .btn-light:hover {
        background-color: #e2e6ea;
    }
    .text-end {
        text-align: right;
    }
    /* Button Styles */
.attractive-button {
    background-color: #4CAF50; /* Green */
    border: none;
    color: white;
    padding: 8px 16px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 14px;
    transition-duration: 0.4s;
    cursor: pointer;
    border-radius: 4px;
}

.attractive-button:hover {
    background-color: #45a049; /* Darker Green */
}

.attractive-button:active {
    background-color: #3e8e41; /* Dark Green */
    transform: translateY(1px);
}

.attractive-button:focus {
    outline: none;
}

/* Additional styling for rounded corners */
.rounded {
    border-radius: 20px;
}

    </style>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body>
    <%- include('../adminpartials/slider.ejs') %>
    <div class="screen-overlay"></div>

    <main>
        <section class="content-main">
            <div class="text-center text-bold text-large">User List</div>
            <div class="content-header"></div>
        
            <div class="card">
                <div class="card-header">
                    <div class="row">
                        <div class="col-lg-3 col-sm-3 col-4 text-bold text-green">Patient Name</div>
                        <div class="col-lg-4 col-sm-4 col-8 text-bold text-green">Email</div>
         
                    </div>
                </div>
        
                <div class="card-body">
                    <% data.forEach((user) => { %>
                        <article class="itemlist">
                            <div class="row">
                                <div class="col-lg-3 col-sm-3 col-4">
                                    <span class="text-bold text-large"><%= user.firstname %> <%= user.lastname %></span>
                                </div>
                                <div class="col-lg-4 col-sm-4 col-8">
                                    <span class="text-bold text-large"><%= user.email %></span>
                                </div>
                                <div class="col-lg-3 col-sm-3 col-4 text-end">
                                    <% if (user.isList) { %>
                                        <button onclick="toggleList('<%= user._id %>')" class="btn btn-sm rounded btn-light attractive-button">
                                            List
                                        </button>
                                    <% } else { %>
                                        <button onclick="toggleList('<%= user._id %>')" class="btn btn-sm rounded btn-light attractive-button">
                                            Unlist
                                        </button>
                                    <% } %>
                                </div>
                                
                            </div> <!-- row .// -->
                        </article> <!-- itemlist  .// -->
                    <% }); %>
                </div> <!-- card-body end// -->
            </div> <!-- card end// -->
        </section> <!-- content-main end// -->
       
        <footer class="main-footer font-xs">
            <div class="row pb-30 pt-15">
                <div class="col-sm-6">
                    <script>
                        document.write(new Date().getFullYear())
                    </script>
                </div>
                <div class="col-sm-6">
                    <div class="text-sm-end"></div>
                </div>
            </div>
        </footer>
    </main>

    <script src="/assetsb/js/vendors/jquery-3.6.0.min.js"></script>
    <script src="/assetsb/js/vendors/bootstrap.bundle.min.js"></script>
    <script src="/assetsb/js/vendors/select2.min.js"></script>
    <script src="/assetsb/js/vendors/perfect-scrollbar.js"></script>
    <script src="/assetsb/js/vendors/jquery.fullscreen.min.js"></script>
    <!-- Main Script -->
    <script src="/assetsb/js/main.js" type="text/javascript"></script>

    <script>
        async function deleteUser(userId) {
            try {
                const result = await Swal.fire({
                    title: 'Are you sure?',
                    text: "You won't be able to revert this!",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Yes, delete it!'
                });

                if (result.isConfirmed) {
                    const response = await fetch(`/admin/deleteuser/${userId}`, {
                        method: 'DELETE'
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }

                    const data = await response.json();
                    console.log(data);

                    Swal.fire('Deleted!', 'User has been deleted.', 'success').then(() => {
                        // Reload the page to reflect changes
                        window.location.reload();
                    });
                }
            } catch (error) {
                console.error('Fetch error:', error);
                Swal.fire('Error!', 'An error occurred while deleting the user.', 'error');
            }
        }
    </script>
<script>
    function toggleList(userId) {
        fetch(`/admin/userlist/${userId}`, {
            method: 'POST', // or 'GET', 'PUT', 'DELETE', etc.
            // Additional fetch options like headers can be added here if needed
        })
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }
            // Handle the response as needed
            console.log('Toggle List success');
            // Show success alert using SweetAlert
            Swal.fire({
                icon: 'success',
                title: 'Success!',
                text: 'User list status toggled successfully',
            }).then(() => {
                // Reload the current page
                window.location.reload();
            });
        })
        .catch(error => {
            console.error('Fetch error:', error);
            // Show error alert using SweetAlert
            Swal.fire({
                icon: 'error',
                title: 'Error!',
                text: 'An error occurred while toggling user list status',
            });
        });
    }
</script>


    
</body>
</html>
